<%
      validacion = @proyecto.validaciones.includes(:tvalidacion).where('tvalidaciones.clave':'SOLV').last
%>

<div class="w-full p-1  bg-white border border-gray-200 rounded-lg shadow sm:p-8 dark:bg-gray-800 dark:border-gray-700">
   <h5 class="mb-1 text-xl font-semibold tracking-tight text-gray-900 dark:text-white">Proyecto</h5>
   <p class="mb-1 font-normal text-gray-500 dark:text-gray-400">Informaci√≥n</p>

   <div class="flex justify-center" data-controller="mautorizado mejercido">
     <table class="table-auto w-9/12 ">
         <tbody>
                   <%= render "proyectos/tr", titulo:'Nombre del proyecto:', valor: @proyecto.nombre  %>
                   <%= render "proyectos/tr", titulo:'Investigador(a) responsable:', valor: @proyecto.participante.pacademicos.where(responsable:true).first.academico.persona.ap_nom_prop %>

                   <tr class="">
                         <td class="font-semibold p-2 text-right border-b border-slate-300" style='width:300px;'>Convenio firmado:</td>
                         <td class="p-2 border-b border-slate-300">
                              <div style="display:flex; flex-direction:column;">
                                   <div> <%= render 'proyectos/planconv' %> </div>
                                   <div style="font-size:12px; color:#6C1303; font-weight:bold; font-style: italic;">(En caso de existir)<div>
                              </div>          
                         </td>
                   </tr>
                   <tr class="">
                         <td class="font-semibold p-2 text-right border-b border-slate-300" style='width:300px;'></td>
                         <td class="p-2 border-b border-slate-300">
                              <label class="inline-flex items-center mb-5 cursor-pointer" >
                                <% if @proyecto.seguimiento %>   
                                    <input type="checkbox" value="" class="sr-only peer" data-controller="etapasvalpy" data-action="click->etapasvalpy#seguimiento" data-etapasvalpy-idpy-param="<%= @proyecto.id %>" checked="checked">
                                    <div class="relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:w-5 after:h-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"></div>
                                    <span class="ms-3 text-sm font-medium text-gray-900 dark:text-gray-300">Proyecto activado para seguimiento</span>
                                <% else %>
                                   <input type="checkbox" value="" class="sr-only peer" data-controller="etapasvalpy" data-action="click->etapasvalpy#seguimiento" data-etapasvalpy-idpy-param="<%= @proyecto.id %>">
                                   <div class="relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:w-5 after:h-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"></div>
                                   <span class="ms-3 text-sm font-medium text-gray-900 dark:text-gray-300">Activar proyecto para seguimiento</span>
                                <% end %> 
                                   
                              </label>
                         </td>
                   </tr>
                   <tr>
                      <td colspan="2"> 
                         <div class="w-full" style="min-height:100px; "> 
                             <%= turbo_frame_tag "monto_autorizado", src:proyecto_mtoautorizados_path(@proyecto) do  %>
                             <% end %>
                         </div> 
                      </td>  
                   </tr>
                   
                  <!--                     
                   <% if !@proyecto.mtoautorizado.nil? %> 
                        <tr>
                           <td colspan="2" class="font-semibold p-2 text-center border-b border-slate-300" style='width:300px;'>  
                              <%= render 'mtoautorizados/vautorizado' %>
                           </td>
                        <tr>
                   <% else %>
                          <tr>
                           <td colspan="2" class="font-semibold p-2 text-center border-b border-slate-300" style='width:300px;'>  
                                 <span class="italic">Sin asignar</span>
                           </td>
                        <tr>
                   <% end %>
                   -->
                   <tr>
                        <td colspan="2" >
                              <div class="w-full" style="min-height:100px; "> 
                                   <%= turbo_frame_tag "monto_ejercido", src:proyecto_mtoejercidos_path(@proyecto) do  %>
                                   <% end %>
                              </div> 
                        </td>
                   </tr>

                   <!--
                   <% if @proyecto.mtoejercidos.any? %> 
                        <tr>
                           <td colspan="2" class="font-semibold p-2 text-center border-b border-slate-300" style='width:300px;'>  
                              <%= render 'mtoautorizados/vejercido' %>
                           </td>
                        <tr>
                   <% else %>
                          <tr>
                           <td colspan="2" class="font-semibold p-2 text-center border-b border-slate-300" style='width:300px;'>  
                                 <span class="italic">Sin asignar</span>
                           </td>
                        <tr>
                   <% end %>
                   -->
                   
                   <% if !@proyecto.recurso.omitir.nil? %> 
                       <% if !@proyecto.recurso.concurrentes.blank? %> 
                              <tr class="bg-gray-300">
                                   <td colspan="2" class="font-semibold p-1 text-center border-b border-slate-300" style='width:300px;'>Monto Concurrente </td>
                              </tr> 
                              <tr>
                                   <td colspan="2" class="font-semibold p-2 text-center border-b border-slate-300" style='width:300px;'>  
                                        
                                        <%= render partial: '/proyectos/pdf/recursos', formats:[:html], locals:{items:@proyecto.recurso.concurrentes} %>
                                        
                                   </td>
                              <tr>
                       <% else %>  
                         <!-- 
                              <tr class="bg-gray-300">
                                   <td colspan="2" class="font-semibold p-1 text-center border-b border-slate-300" style='width:300px;'>Monto Concurrente </td>
                              </tr>        
                              <tr>
                                    <td colspan="2" class="font-semibold p-2 text-center border-b border-slate-300" style='width:300px;'>  
                                        <span class="italic">Sin recursos</span>
                                    </td>
                              <tr>
                         -->          
                       <% end %>            
                   <% else %>
                        <!--
                          <tr class="bg-gray-300">
                                   <td colspan="2" class="font-semibold p-1 text-center border-b border-slate-300" style='width:300px;'>Monto Concurrente </td>
                              </tr> 
                          <tr>
                           <td colspan="2" class="font-semibold p-2 text-center border-b border-slate-300" style='width:300px;'>  
                                 <span class="italic">Sin recursos</span>
                           </td>
                        <tr>
                       -->  
                   <% end %>

         </tbody>   
      </table>
  </div>
</div> 