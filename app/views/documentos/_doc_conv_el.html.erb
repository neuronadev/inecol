<%= form_with model:@proyecto do |form| %>
   <input type="hidden" name="el_odoc" value="elodoc_edit">
   <div class="md:flex md:items-center mb-3">
        <div class="md:w-1/5">
                  <div class='md:text-right mb-1 md:mb-0 pr-4' id="proyecto_protocolos"></div>
        </div>
        <div class="md:w-3/5 p-0">
               <div class='font-semibold'>Convenio, Contrato o algún otro Documento Legal:</div>
                    <div id = "div_file" class="md:w-full ml-3">
                         <% if @proyecto.docconvenios.attached? %>
                                                <% @proyecto.docconvenios.each do |doc| %>
                                                           <div id = "div_file" class=" md:w-full p-2" data-controller="upsf">
                                                                   <%= form.file_field :docconvenios, class:'item_file', style:'display:none;',  multiple:true, direct_upload: true, data: { upsf_target: "input", action: "change->upsf#uploadFile"} %>
                                                                   <%= link_to doc.filename, rails_blob_path(doc, disposition:'inline'), target:'_blank', class:'item_file text-blue-700' %>
                                                                   <button class='item_file ml-2 text-red-700' data-action='click->upsf#delFileEdit' data-upsf-idpy-param='<%= doc.id %>'>Eliminar</button>
                                                           </div>
                                                <% end %>
                        <% else %>         
                                                   <div id = "div_file" class=" md:w-full p-2" data-controller="upsf">
                                                           <%= form.file_field :docconvenios, class:'item_file', multiple:true, direct_upload: true, data: { upsf_target: "input", action: "change->upsf#uploadFile"} %>
                                                   </div> 
                        <% end %>         
                    </div>    

        </div>
    </div>
    <div class="md:flex-col md:items-center mb-3">
     <div class="md:w-1/5">
                  <div class='md:text-right mb-1 md:mb-0 pr-4'></div>
     </div>
     <div class="md:w-2/5 p-0">
         <div class="font-semibold flex"> <div><%= inline_svg_tag 'svg/historia.svg' %></div> <div class="ml-3">Histórico</div></div>
     </div>    
     <div class="flex-col">
         <% Dhistorico.where(record_id:@proyecto.id, record_type:'Proyecto', name:'docconvenios').each do |item|  %> 
                 <%  b =  ActiveStorage::Blob.find(item.blob_id) %>
                 <div class="flex"> 
                    <div class="ml-5"><%= link_to b.filename, rails_blob_path(b, disposition:'inline'), target:'_blank', class:'item_file text-gray-500' %></div>
                    <div class="ml-2 text-gray-500"> <%= b.created_at.strftime("%d-%m-%Y") %> </div>
                 </div>   

         <% end %>
     </div>
</div>
    <div class="md:flex md:items-center justify-end border-t-2 border-gray-100 p-2">
                        <button type="submit" class="text-white bg-green-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center dark:bg-green-600 dark:hover:bg-green-700 dark:focus:ring-green-800" 
                                 data-turbo-frame= 'py_content_secc' 
                                >
                            Aplicar cambios
                        </button>
    </div>
         
<% end %>